<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<div id="wrapper">
  <navigation [loginInfo]="loginInfo" *ngIf="loginInfo"></navigation>

  <div id="page-wrapper" class="gray-bg">

    <topnavbar></topnavbar>
    
    <div class="container">
      <div class="table-wrapper" style="height: 600px;width: 90%;
      overflow-y: scroll;">
        <div class="table-title">
          <div class="row">
            <div class="col-sm-8">
              <h2>MIS <b>Report</b></h2> 
              <!-- <a style="float: inherit; margin-top: 2%;" type="button"
                href="./assets/misReport.xlsx" class="btn btn-info add-new {{buttonDisabled}}"><i class="fa fa-plus"></i>
                Export</a> -->
                <a style="float: inherit; margin-top: 2%;" type="button"
                (click)="export()" class="btn btn-info add-new {{buttonDisabled}}"><i class="fa fa-plus"></i>
                Export</a>

            </div>
          </div>
          <div class="row" style="margin-top: 2%;">
            <div class="col-sm-1">
              From
            </div>
            <div class="col-sm-5">
              <angular2-date-picker [(ngModel)]="datefrom" (onDateSelect)="fromDateSelect($event)"
                [settings]="settings"></angular2-date-picker>
            </div>
            <div class="col-sm-1">
              To
            </div>
            <div class="col-sm-5">
              <angular2-date-picker [(ngModel)]="dateto" (onDateSelect)="toDateSelect($event)" [settings]="settings">
              </angular2-date-picker>

            </div>
            <div class="row" style="margin-top: 8%;">
              <div class="col-sm-1">Select Campaing</div>
              <!-- <div style="z-index: 10;">
                <img alt="image" class="img-custom" height="60" src="./assets/img/loader.gif" style="position: absolute;
                z-index: 10;
                width: 20%;
                height: 20%;
                left: 35%;" />
              </div> -->

              <div class="col-sm-4">
                <angular4-multiselect [data]="dropdownList" [(ngModel)]="selectedItems" [settings]="dropdownSettings"
                  (onSelect)="onItemSelect($event)" (onDeSelect)="OnItemDeSelect($event)"
                  (onSelectAll)="onSelectAll($event)" (onDeSelectAll)="onDeSelectAll($event)"></angular4-multiselect>
              </div>
              <div class="col-sm-4">
                  <angular4-multiselect [data]="dropdownUserList" (click)="populateUser()" [(ngModel)]="selectedUserItems" [settings]="dropdownUserSettings"></angular4-multiselect>
                </div>
              <div class="col-sm-3">
                  <button class="btn btn-info add-new" (click)="fetchReportData(1000,1000)">Submit</button>
                </div>
            </div>
            
            
          </div>
        </div>
        <div *ngIf="loading" class="loader"></div>
        

        <table  class="table table-bordered " >
          <thead>
            <tr>
              <td *ngFor="let stat of status;">{{stat}}</td>
              <!-- <td>LEAD</td>
              <td>BUSY </td>
              <td>OCCUPIED</td>
              <td>SWITCHOFF</td>
              <td>CALLBACK</td>
              <td>Not Rechable</td> -->
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let data of reportData;">
              <td *ngFor="let stat of status;">{{data[stat]}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="footer">
      <div>
        <strong>Copyright</strong> Microsmart &copy; 2020
      </div>
    </div>
  </div>
</div>
